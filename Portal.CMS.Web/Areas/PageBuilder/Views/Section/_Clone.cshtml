@model Portal.CMS.Web.Areas.PageBuilder.ViewModels.Section.CloneViewModel
@{
    Layout = "";
}

<script type="text/javascript">
    function submit()
    {
        var pageId = $('#PageId').val();

        $.ajax({
            type: "POST",
            url: "/PageBuilder/Section/Clone",
            data: { 'pageAssociationId': @Model.PageAssociationId, 'pageId': pageId },
            success: function (data)
            {
                $('.popover').popover('hide');

                var buttonElement = $('.action[data-title="Clone Section"][data-association=@Model.PageAssociationId]');
                var iconElement = $('.action[data-title="Clone Section"][data-association=@Model.PageAssociationId] span');

                iconElement.removeClass('fa-clone').addClass('fa-check');
                buttonElement.addClass('green');

                setInterval(function () {
                    iconElement.addClass('fa-clone').removeClass('fa-check');
                    buttonElement.removeClass('green');
                }, 2000);
            },
            error: function ()
            {
                $('#clone-help').removeClass("alert-warning");
                $('#clone-help').addClass("alert-danger");
                $('#clone-help').text("An error occured, please try again");
            }
        });
    }
</script>

@if (Model.PageListOptions.Any())
{
    <div id="clone=spinner" class="spinner" style="display: none;"></div>
    <div id="clone-help" class="alert alert-warning" role="alert">Clone a Section onto another Page to keep your content synced across all relevant pages</div>

    @Html.ValidationMessageFor(x => x.PageId)
    <div class="control-group">
        @Html.LabelFor(x => x.PageId)
        @Html.DropDownListFor(m => m.PageId, Model.PageListOptions)
    </div>

    <div class="footer">
        <div class="btn primary" onclick="submit();"><span class="fa fa-check"></span><span class="hidden-xs">Clone</span></div>
        <div class="btn close-popover"><span class="fa fa-times"></span><span class="hidden-xs">Cancel</span></div>
    </div>
}
else
{
    <div class="alert alert-danger" role="alert">You can't clone this Section because you don't have any other pages...</div>

    <div class="footer">
        <div class="btn close-popover"><span class="fa fa-times"></span><span class="hidden-xs">Cancel</span></div>
    </div>
}