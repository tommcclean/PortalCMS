function ExtractSectionId(n){var i=$(n).attr("id"),t=i.split("-");return t[t.length-1]}function ChangeOrder(){$("#page-wrapper").toggleClass("zoom");$("#page-wrapper").toggleClass("change-order");$("#page-wrapper.change-order").sortable({placeholder:"ui-state-highlight",helper:"clone"});$(".action-container.global").fadeOut();$(".action-container.section-order").fadeIn()}function SaveOrder(){var n=[],t=1;$("#page-wrapper .sortable").each(function(){var i=$(this).attr("data-section");n.push(t+"-"+i);t+=1});$("#order-list").val(n);$("#order-submit").click()}$(document).ready(function(){$(".add-component").click(function(){var n=$(this).attr("data-sectionid"),i=$("#section-"+n+" .component-container.selected:first").attr("id"),t;i===undefined?(t="/Builder/Component/Add?pageSectionId="+n+"&elementId=section-"+n,showModalEditor("Add Component",t)):(t="/Builder/Component/Add?pageSectionId="+n+"&elementId="+i,showModalEditor("Add Component",t))});$(".admin section .image").click(function(n){var t=n.target.id,i=ExtractSectionId($(this)),r="/Builder/Component/Image?pageSectionId="+i+"&elementId="+t;showModalEditor("Edit Image Properties",r)});$(".admin section").click(function(){var t=$(this).attr("id"),n=ExtractSectionId($(this));$(this).find(".component-container").removeClass("selected");$("#container-editor-"+n).fadeOut()}).children().click(function(){return!1});$(".admin .component-editor").click(function(){var r=$(this).attr("id"),n=ExtractSectionId($(this)),t=$("#section-"+n+" .component-container.selected:first").attr("id"),i;$("#"+t).remove();i={pageSectionId:n,elementId:t};$.ajax({data:i,type:"POST",cache:!1,url:"/Builder/Component/Delete",success:function(n){n.State===!1&&(alert("Error: The Page has lost synchronisation. Reloading Page..."),location.reload())}})});$(".admin .component-container").click(function(){var t=$(this).attr("id"),n=ExtractSectionId($(this));$(this).hasClass("selected")?($(this).removeClass("selected"),$("#container-editor-"+n).fadeOut()):($(".component-container").removeClass("selected"),$(".component-editor").fadeOut(200),$("#container-editor-"+n).fadeIn(200),$(this).addClass("selected"))}).children().click(function(){return!1});tinymce.init({selector:".admin section p, .admin section h1, .admin section h2, .admin section h3, .admin section h4",menubar:!1,inline:!0,plugins:["advlist textcolor colorpicker link"],toolbar:"undo redo | bold italic underline | link | forecolor backcolor | delete",setup:function(n){n.addButton("delete",{text:"Delete",icon:!1,onclick:function(){var n=tinyMCE.activeEditor.id,t=n.split("-"),i=t[t.length-1],r={pageSectionId:i,elementId:n};$("#"+n).remove();$.ajax({data:r,type:"POST",cache:!1,url:"/Builder/Component/Delete",success:function(n){n.State===!1&&(alert("Error: The Page has lost synchronisation. Reloading Page..."),location.reload())}})}});n.on("change",function(){var t=tinyMCE.activeEditor.id,i=t.split("-"),r=i[i.length-1],u={pageSectionId:r,elementId:t,elementHtml:n.getContent()};$.ajax({data:u,type:"POST",cache:!1,url:"/Builder/Component/Edit",success:function(n){n.State===!1&&(alert("Error: The Page has lost synchronisation. Reloading Page..."),location.reload())}})})}});tinymce.init({selector:".admin section a, .admin section .btn",menubar:!1,inline:!0,plugins:["advlist textcolor colorpicker link"],toolbar:"undo redo | bold italic underline | link | forecolor backcolor | delete",setup:function(n){n.addButton("delete",{text:"Delete",icon:!1,onclick:function(){var n=tinyMCE.activeEditor.id,t=n.split("-"),i=t[t.length-1],r={pageSectionId:i,elementId:n};$("#"+n).remove();$.ajax({data:r,type:"POST",cache:!1,url:"/Builder/Component/Delete",success:function(n){n.State===!1&&(alert("Error: The Page has lost synchronisation. Reloading Page..."),location.reload())}})}});n.on("change",function(){var t=tinyMCE.activeEditor.id,i=t.split("-"),r=i[i.length-1],u=$("#"+t).attr("href"),f=$("#"+t).attr("target"),e={pageSectionId:r,elementId:t,elementHtml:n.getContent(),elementHref:u,elementTarget:f};$.ajax({data:e,type:"POST",cache:!1,url:"/Builder/Component/Link",success:function(n){n.State===!1&&(alert("Error: The Page has lost synchronisation. Reloading Page..."),location.reload())}})})}})});